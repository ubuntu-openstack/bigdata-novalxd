# We want the same Big Data bundle to be deployable on metal and on OpenStack
#
#
machines:
# Juju Bootstrap / Controller
  '0':
    constraints: arch=amd64 tags=demo
    series: xenial
# Misc Admin Non-Big-Data
  '1':
    constraints: arch=amd64 tags=demo
    series: xenial
# Misc Admin Non-Big-Data
  '2':
    constraints: arch=amd64 tags=demo
    series: xenial
# NN - Apache Hadoop HDFS NameNode
  '3':
    constraints: arch=amd64 tags=demo
    series: xenial
# RM - Apache Hadoop YARN Resource Manager
  '4':
    constraints: arch=amd64 tags=demo
    series: xenial
# SP - Apache Spark Processing
  '5':
    constraints: arch=amd64 tags=demo
    series: xenial
# SV - Apache Hadoop Slave
  '6':
    constraints: arch=amd64 tags=demo
    series: xenial
# SV - Apache Hadoop Slave
#  '7':
#    constraints: arch=amd64 tags=demo
#    series: xenial
# SV - Apache Hadoop Slave
#  '8':
#    constraints: arch=amd64 tags=demo
#    series: xenial
# SV - Apache Hadoop Slave
#  '9':
#    constraints: arch=amd64 tags=demo
#    series: xenial
# SV - Apache Hadoop Slave
#  '10':
#    constraints: arch=amd64 tags=demo
#    series: xenial
series: xenial
services:
  ganglia:
    charm: cs:~charmers/trusty/ganglia
    to: "lxc:1"
  ganglia-node:
    charm: "cs:~charmers/trusty/ganglia-node"
  namenode:
    charm: "cs:~bigdata-dev/xenial/hadoop-namenode"
    annotations:
      gui-x: "300"
      gui-y: "600"
    num_units: 1
    to: 3
  resourcemanager:
    charm: "cs:~bigdata-dev/xenial/hadoop-resourcemanager"
    annotations:
      gui-x: "300"
      gui-y: "0"
    num_units: 1
    to: 4
  spark:
    charm: "cs:~bigdata-dev/xenial/spark"
    annotations:
      gui-x: "300"
      gui-y: "300"
    to: 5
  slave:
    charm: "cs:~bigdata-dev/xenial/hadoop-slave"
    annotations:
      gui-x: "0"
      gui-y: "300"
    num_units: 1
    to: 6
  #client:
  #  charm: "cs:~bigdata-dev/xenial/hadoop-client"
  #  annotations:
  #    gui-x: "900"
  #    gui-y: "300"
  #  num_units: 1
  plugin:
    charm: "cs:~bigdata-dev/xenial/hadoop-plugin"
    annotations:
      gui-x: "600"
      gui-y: "300"
  openjdk:
    charm: "cs:xenial/openjdk"
    annotations:
      gui-x: "300"
      gui-y: "300"
    options:
      java-type: "jdk"
      java-major: "8"
relations:
  - [resourcemanager, namenode]
  - [namenode, slave]
  - [resourcemanager, slave]
  - [plugin, namenode]
  - [plugin, resourcemanager]
  - [plugin, spark]
#  - [client, plugin]
  - [openjdk, namenode]
  - [openjdk, resourcemanager]
  - [openjdk, slave]
#  - [openjdk, client]
  - [openjdk, spark]
  # ganglia:node relations
  - ["ganglia:node", namenode]
  - ["ganglia:node", resourcemanager]
  - ["ganglia:node", slave]
  - ["ganglia:node", ganglia-node]
  # ganglia subordinate relations
  - [ganglia-node, namenode]
  - [ganglia-node, resourcemanager]
  - [ganglia-node, slave]
